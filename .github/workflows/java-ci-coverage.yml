name: Java CI Coverage

on:
    push:
        branches: [ "main" ]
    pull_request:

jobs:
    coverage:
        runs-on: ubuntu-latest

        steps:
            - name: 📥 Checkout code
              uses: actions/checkout@v4

            - name: ☕ Set up JDK 21
              uses: actions/setup-java@v4
              with:
                  java-version: '21'
                  distribution: 'temurin'
                  cache: gradle

            - name: ⚡ Grant execute permission for Gradlew
              run: chmod +x gradlew
              working-directory: examples/java-basic-app

            - name: 🏗️ Build with Gradle
              run: ./gradlew clean build jacocoTestReport --no-daemon
              working-directory: examples/java-basic-app

            - name: 📊 Upload JaCoCo Coverage Report
              uses: actions/upload-artifact@v4
              with:
                  name: jacoco-coverage-report
                  path: examples/java-basic-app/build/reports/jacoco/test/html/*.html
